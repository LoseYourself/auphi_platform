<link rel="shortcut icon" href="../image/g4.ico" />  
<link rel="stylesheet" type="text/css" href="../css/ext_icon.css"/>
<link rel="stylesheet" type="text/css" href="../theme/gray/resources/css/ext-all.css"/>
<script type="text/javascript" src="adapter/ext/ext-base.js"></script>
  <script type="text/javascript" src="ext-all-debug.js"></script>
  <link rel="stylesheet" type="text/css" href="../css/ext_css_patch.css" />
<script type="text/javascript" src="../commonjs/ext-lang-zh_CN.js"></script>
<script type="text/javascript" src="../commonjs/eredg4.js"></script>
<link rel="stylesheet" type="text/css" href="../css/eredg4.css"/>
<script type="text/javascript" src="ux/ux-all.js"></script>
<link rel="stylesheet" type="text/css" href=".ux/css/ux-all.css"/>


<!-- 由<eRedG4:arm.SelectUserTree/>标签生成的代码开始 -->
<div id="selectOperationTreeDiv"></div>
<script type="text/javascript">
Ext.onReady(function() {
	var node_01 = new Ext.tree.TreeNode({
		text:'系统集成与开发平台',	
		id:'id_node_01'
	});
	var node_01010301 = new Ext.tree.TreeNode({
		text:'字典维护',	
		id:'id_node_01010301'
	});
	var node_01010403 = new Ext.tree.TreeNode({
		text:'Requst请求跟踪',	
		id:'id_node_01010403'
	});
	var node_01010201 = new Ext.tree.TreeNode({
		text:'组织机构管理',	
		id:'id_node_01010201'
	});
	var node_010102 = new Ext.tree.TreeNode({
		text:'权限管理',	
		id:'id_node_010102'
	});
	var node_0101 = new Ext.tree.TreeNode({
		text:'系统管理',	
		id:'id_node_0101'
	});
	var node_01010204 = new Ext.tree.TreeNode({
		text:'角色管理与授权',	
		id:'id_node_01010204'
	});
	var node_01010401 = new Ext.tree.TreeNode({
		text:'Session会话监控',	
		id:'id_node_01010401'
	});
	var node_01010303 = new Ext.tree.TreeNode({
		text:'全局参数表维护',	
		id:'id_node_01010303'
	});
	var node_010103 = new Ext.tree.TreeNode({
		text:'基础数据维护',	
		id:'id_node_010103'
	});
	var node_01010405 = new Ext.tree.TreeNode({
		text:'JDBC执行监控',	
		id:'id_node_01010405'
	});
	var node_010104 = new Ext.tree.TreeNode({
		text:'运行监控',	
		id:'id_node_010104'
	});
	var node_01010209 = new Ext.tree.TreeNode({
		text:'菜单操作权限管理',	
		id:'id_node_01010209'
	});
	var node_01010202 = new Ext.tree.TreeNode({
		text:'人员管理与授权',	
		id:'id_node_01010202'
	});
	var node_01010205 = new Ext.tree.TreeNode({
		text:'菜单资源管理',	
		id:'id_node_01010205'
	});
	var node_01010406 = new Ext.tree.TreeNode({
		text:'Service监控',	
		id:'id_node_01010406'
	});
	var node_01010206 = new Ext.tree.TreeNode({
		text:'UI元素托管',	
		id:'id_node_01010206'
	});
	var node_01010407 = new Ext.tree.TreeNode({
		text:'服务器信息',	
		id:'id_node_01010407'
	});
	var node_01010207 = new Ext.tree.TreeNode({
		text:'UI元素角色授权',	
		id:'id_node_01010207'
	});
	var node_01010208 = new Ext.tree.TreeNode({
		text:'UI元素人员授权',	
		id:'id_node_01010208'
	});
	var node_10000209 = new Ext.tree.TreeNode({
		text:'新增',
    checked:false,	
		functionid:'10000209',
		id:'id_node_10000209'
	});

	node_010103.appendChild(node_01010301);
	node_010104.appendChild(node_01010403);
	node_010102.appendChild(node_01010201);
	node_0101.appendChild(node_010102);
	node_01.appendChild(node_0101);
	node_010102.appendChild(node_01010204);
	node_010104.appendChild(node_01010401);
	node_010103.appendChild(node_01010303);
	node_0101.appendChild(node_010103);
	node_010104.appendChild(node_01010405);
	node_0101.appendChild(node_010104);
	node_010102.appendChild(node_01010209);
	node_010102.appendChild(node_01010202);
	node_010102.appendChild(node_01010205);
	node_010104.appendChild(node_01010406);
	node_010102.appendChild(node_01010206);
	node_010104.appendChild(node_01010407);
	node_010102.appendChild(node_01010207);
	node_010102.appendChild(node_01010208);
	node_01010201.appendChild(node_10000209);

var selectOperationTree = new Ext.tree.TreePanel({
			autoHeight : false,
			autoWidth : false,
			autoScroll : true,
			animate : false,
			rootVisible : true,
			border : false,
			containerScroll : true,
			applyTo : 'selectOperationTreeDiv',
			tbar : [{
				text : '保存',
				id : 'selectOperation_saveBtn',
				iconCls : 'acceptIcon',
				handler : function() {
					     var checkedNodes = selectOperationTree.getChecked();
					     var functionid = "";
						 for(var i = 0; i < checkedNodes.length; i++) {
						   var checkNode = checkedNodes[i];
					       functionid = functionid + checkNode.attributes.functionid + "," ;  
						 }
						 saveOperation(functionid);
				 }
		    }, '-', {
				text : '展开',
				iconCls : 'expand-allIcon',
				handler : function() {
					selectOperationTree.expandAll();
				}
		    }, '-', {
				text : '收缩',
				iconCls : 'collapse-allIcon',
				handler : function() {
					selectOperationTree.collapseAll();
				}
		    }],
			root : node_01
  });
  //node_${deptid}.expand();
  //selectOperationTree.expandAll();

//保存授权数据
function saveOperation(functionid){
		showWaitMsg();
		Ext.Ajax.request({
					url : './function.ered?reqCode=saveUser',
					success : function(response) {
						var resultArray = Ext.util.JSON.decode(response.responseText);
						Ext.Msg.alert('提示', resultArray.msg);
					},
					failure : function(response) {
						var resultArray = Ext.util.JSON.decode(response.responseText);
						Ext.Msg.alert('提示', resultArray.msg);
					},
					params : {
						userid : pUserid,
						functionid：functionid
					}
				});
}
	
})
</script>
<!-- 由<eRedG4:arm.SelectUserTree/>标签生成的代码结束 -->

